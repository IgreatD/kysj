(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0df22aac"],{"0bc9":function(e,t,a){"use strict";a("96cf");var r=a("3b8d"),n=a("d225"),o=a("b0b4"),c=a("308d"),i=a("6bb5"),u=a("4e2b"),l=a("9ab4"),s=a("60a3"),d=a("d257"),f=a("54c5"),p=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(i.a)(t).apply(this,arguments))).formModel={},e.current={},e}var a;return Object(u.a)(t,e),Object(o.a)(t,[{key:"checkCurrentNotNull",value:function(){var e=this;return new Promise((function(t){Object(d.d)(e.current)?e.$message.warning("请选择需要操作的表格"):t(e.current)}))}},{key:"getData",value:(a=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:return e.next=4,this.baseTable.getData();case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),t}(Object(s.c)(f.a));Object(l.a)([Object(s.f)()],p.prototype,"baseTable",void 0),p=Object(l.a)([s.a],p),t.a=p},"42b2":function(e,t,a){"use strict";a.r(t);a("96cf");var r=a("3b8d"),n=a("d225"),o=a("b0b4"),c=a("308d"),i=a("6bb5"),u=a("4e2b"),l=a("9ab4"),s=a("60a3"),d=a("9c8d"),f=[{type:"selection",width:65},{label:"角色",prop:"roleName"},{label:"角色备注",prop:"roleRemark"},{label:"状态",width:120,h:function(e,t){var a="1"===t.row.status;return e("el-tag",{attrs:{type:a?"primary":"info"}},a?"启用":"停用")}}],p=a("54c5"),b=a("0bc9"),h=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),g=a("e2e8");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(i.a)(t).apply(this,arguments))).formModel={},e.formRules={roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],status:[{required:!0,message:"请选择角色状态",trigger:"change"}]},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"initFormModel",value:function(e){this.formModel={roleId:e.roleId,roleName:e.roleName,remark:e.roleRemark,status:e.status}}},{key:"addOrUpdate",value:function(){var e=this;this.$refs.formRef.validate((function(t){if(!t)return!1;e.updateLoading=!0,e.http({url:d.a.addRole,data:O({},e.formModel)}).then((function(){e.$message.success("角色添加成功"),e.syncShow=!1,e.updateLoading=!1,e.updateSuccess()})).catch((function(t){e.$message.error(t.message||"角色添加失败"),e.updateLoading=!1}))}))}},{key:"title",get:function(){return"".concat(this.confirmText,"角色")}}]),t}(Object(s.c)(g.a));Object(l.a)([Object(s.h)("dialogData")],y.prototype,"initFormModel",null);var v=y=Object(l.a)([s.a],y),j=a("2877"),k=Object(j.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-dialog",{attrs:{visible:e.syncShow,title:e.title},on:{"update:visible":function(t){e.syncShow=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{attrs:{type:e.confirmType,loading:e.updateLoading},on:{click:e.addOrUpdate}},[e._v(e._s(e.confirmText))])]},proxy:!0}])},[e._v(" "),a("el-form",{ref:"formRef",attrs:{model:e.formModel,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.formModel.roleName,callback:function(t){e.$set(e.formModel,"roleName",t)},expression:"formModel.roleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色状态",prop:"status"}},[a("el-radio-group",{model:{value:e.formModel.status,callback:function(t){e.$set(e.formModel,"status",t)},expression:"formModel.status"}},[a("el-radio",{attrs:{label:"1"}},[e._v("正常")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("停用")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.formModel.remark,callback:function(t){e.$set(e.formModel,"remark",t)},expression:"formModel.remark"}})],1)],1)],1)}),[],!1,null,null,null).exports,w=(a("28a5"),a("d257")),D=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(i.a)(t).apply(this,arguments))).defaultProps={children:"childList",label:"name"},e.data=[],e.keys=[],e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"open",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this.loading=!0,this.http({url:d.a.getMenuFunction,data:{roleId:this.dialogData.roleId}}).then((function(t){var a=t.data;e.data=a.data,e.keys=a.keys.split(","),e.loading=!1})).catch((function(){e.loading=!1}))}},{key:"allot",value:function(){var e=this,t=this.$refs.tree.getCheckedKeys();this.keys=t.filter((function(e){return!Object(w.d)(e)})),this.updateLoading=!0,this.http({url:d.a.setMenuFunction,data:{roleId:this.dialogData.roleId,keys:this.keys.join(",")}}).then((function(){e.$message.success("角色权限分配成功"),e.syncShow=!1,e.updateLoading=!1,e.updateSuccess()})).catch((function(t){e.$message.error(t.message||"角色权限分配失败"),e.updateLoading=!1}))}}]),t}(Object(s.c)(g.a)),S=D=Object(l.a)([s.a],D),x=Object(j.a)(S,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-dialog",{attrs:{visible:e.syncShow,title:"角色权限分配"},on:{"update:visible":function(t){e.syncShow=t},open:e.open},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{attrs:{type:"primary",loading:e.updateLoading},on:{click:e.allot}},[e._v("分配")])]},proxy:!0}])},[e._v(" "),a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tree",attrs:{data:e.data,props:e.defaultProps,"default-checked-keys":e.keys,"show-checkbox":"","node-key":"menuFunctionId"}})],1)}),[],!1,null,null,null).exports,_=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(i.a)(t).apply(this,arguments))).addUpdateDialogShow=!1,e.permissionAllotDialogShow=!1,e}var a;return Object(u.a)(t,e),Object(o.a)(t,[{key:"mounted",value:function(){this.getData()}},{key:"add",value:function(){this.current={},this.addUpdateDialogShow=!0}},{key:"update",value:function(){var e=this;this.checkCurrentNotNull().then((function(){e.addUpdateDialogShow=!0}))}},{key:"powerAllot",value:function(){var e=this;this.checkCurrentNotNull().then((function(){e.permissionAllotDialogShow=!0}))}},{key:"roleOnOff",value:(a=Object(r.a)(regeneratorRuntime.mark((function e(t,a){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkCurrentNotNull();case 2:this.$confirm("此操作将".concat(a,"：").concat(this.current.roleName,", 是否继续?"),"".concat(a,"角色"),{confirmButtonText:"".concat(a),cancelButtonText:"取消",type:"warning"}).then((function(){r.http({url:d.a.roleOnOff,data:{roleId:r.current.roleId,status:t}}).then((function(){r.$message.success("角色".concat(a,"成功")),r.getData()}))}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"url",get:function(){return d.a.getRoles}},{key:"rowHeader",get:function(){return f}}]),t}(Object(s.c)(p.a,b.a)),M=_=Object(l.a)([Object(s.a)({components:{AddUpdateDialog:k,PermissionAllotDialog:x}})],_),N=Object(j.a)(M,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-table",{ref:"baseTable",attrs:{"row-header":e.rowHeader,"show-query":!1,"show-functions":!0,url:e.url},on:{create:e.add,update:e.update,powerallot:e.powerAllot,onuse:function(t){return e.roleOnOff("1","启用")},offuse:function(t){return e.roleOnOff("-1","停用")}},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}}),e._v(" "),a("add-update-dialog",{attrs:{show:e.addUpdateDialogShow,"dialog-data":e.current},on:{"update:show":function(t){e.addUpdateDialogShow=t},"update:dialogData":function(t){e.current=t},"update:dialog-data":function(t){e.current=t},"update-success":e.getData}}),e._v(" "),a("permission-allot-dialog",{attrs:{show:e.permissionAllotDialogShow,"dialog-data":e.current},on:{"update:show":function(t){e.permissionAllotDialogShow=t},"update:dialogData":function(t){e.current=t},"update:dialog-data":function(t){e.current=t},"update-success":e.getData}})],1)}),[],!1,null,null,null);t.default=N.exports},e2e8:function(e,t,a){"use strict";var r=a("d225"),n=a("b0b4"),o=a("308d"),c=a("6bb5"),i=a("4e2b"),u=a("9ab4"),l=a("60a3"),s=a("54c5"),d=a("d257"),f=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(c.a)(t).apply(this,arguments))).formRef=null,e.updateLoading=!1,e}return Object(i.a)(t,e),Object(n.a)(t,[{key:"updateSuccess",value:function(e){return e}},{key:"close",value:function(){Object.assign(this.$data,this.$options.data.call(this))}},{key:"confirmType",get:function(){return Object(d.d)(this.dialogData)?"primary":"warning"}},{key:"confirmText",get:function(){return Object(d.d)(this.dialogData)?"添加":"修改"}}]),t}(Object(l.c)(s.a));Object(u.a)([Object(l.e)("show",{type:Boolean,default:!1})],f.prototype,"syncShow",void 0),Object(u.a)([Object(l.d)({default:function(){return{}}})],f.prototype,"dialogData",void 0),Object(u.a)([Object(l.b)("update-success")],f.prototype,"updateSuccess",null),f=Object(u.a)([l.a],f),t.a=f}}]);